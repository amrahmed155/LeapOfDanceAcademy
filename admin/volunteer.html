<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Leap of Dance Academy | Volunteer</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="assets/vendors/feather/feather.css" />
    <link
      rel="stylesheet"
      href="assets/vendors/mdi/css/materialdesignicons.min.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendors/font-awesome/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="assets/vendors/typicons/typicons.css" />
    <link
      rel="stylesheet"
      href="assets/vendors/simple-line-icons/css/simple-line-icons.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.css"
    />
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <link
      rel="stylesheet"
      href="assets/vendors/datatables.net-bs4/dataTables.bootstrap4.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="assets/js/select.dataTables.min.css"
    />
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/dataTables.dataTables.min.css" />
    <!-- endinject -->
    <link rel="shortcut icon" href="../assets/Icon-01.ico" />
  </head>
  <body class="with-welcome-text">
    <div class="container-scroller">
      <!-- partial:partials/_navbar.html -->
      <nav
        class="navbar default-layout col-lg-12 col-12 p-0 fixed-top d-flex align-items-top flex-row"
      >
        <div
          class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-start"
        >
          <div class="centerImg">
            <a class="navbar-brand brand-logo" href="#">
              <img src="assets/images/logo.png" alt="logo" />
            </a>
          </div>
        </div>
        <div class="navbar-menu-wrapper d-flex align-items-top">
          <ul class="navbar-nav">
            <li class="nav-item fw-semibold d-none d-lg-block ms-0">
              <h1 class="welcome-text">
                Good Morning, <span class="text-black fw-bold">Admin</span>
              </h1>
              <h3 class="welcome-sub-text">volunteer Requests:</h3>
              <button class="btn btn-primary btn-special2" id="exportBtn">
                volunteer Export
              </button>
            </li>
          </ul>
        </div>
      </nav>
      <div class="container-fluid page-body-wrapper">
        <nav class="sidebar sidebar-offcanvas" id="sidebar">
          <ul class="nav">
            <!-- <li class="nav-item">
              <a class="nav-link" href="index.html">
                <i class="mdi mdi-grid-large menu-icon"></i>
                <span class="menu-title">Dashboard</span>
              </a>
            </li>-->

            <li class="nav-item">
              <a class="nav-link" href="./index.html">
                <i class="menu-icon mdi mdi-account-circle-outline"></i>
                <span class="menu-title">Contact</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./register.html">
                <i class="menu-icon mdi mdi-account-circle-outline"></i>
                <span class="menu-title">Register</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./volunteer.html">
                <i class="menu-icon mdi mdi-file-document"></i>
                <span class="menu-title">volunteer</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./sponsorship.html">
                <i class="menu-icon mdi mdi-file-document"></i>
                <span class="menu-title">sponsorship</span>
              </a>
            </li>
          </ul>
        </nav>
        <div class="main-panel">
          <div class="content-wrapper">
            <table id="recordsTable" class="display" style="width: 100%">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Interest Reason</th>
                  <th>Staying Duration</th>
                  <th>Skills</th>
                  <th>GoFundMe Radio</th>
                  <th>GoFundMe Other Reason</th>
                  <th>Ideas</th>
                  <th>Email</th>
                  <th>Phone</th>
                  <th>Status</th>
                  <th>Create Date</th>
                  <th>Action</th>
                </tr>
              </thead>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div
      class="modal fade"
      id="viewModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="viewModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="viewModalLabel">View Record</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewId">ID</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewId"
                      readonly
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewCreateDate">Create Date</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewCreateDate"
                      readonly
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewInterestReason">Interest Reason</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewInterestReason"
                      readonly
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewStayingDuration">Staying Duration</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewStayingDuration"
                      readonly
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewSkills">Skills</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewSkills"
                      readonly
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewGoFundMeRadio">GoFundMe Radio</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewGoFundMeRadio"
                      readonly
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewGoFundMeOtherReason"
                      >GoFundMe Other Reason</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="viewGoFundMeOtherReason"
                      readonly
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewIdeas">Ideas</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewIdeas"
                      readonly
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewEmail">Email</label>
                    <a href="#" id="viewEmailLink"
                      ><input
                        type="email"
                        class="form-control"
                        id="viewEmail"
                        readonly
                    /></a>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewPhone">Phone</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewPhone"
                      readonly
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="viewStatus">Status</label>
                    <input
                      type="text"
                      class="form-control"
                      id="viewStatus"
                      readonly
                    />
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Custom js for this page-->
    <link rel="stylesheet" href="assets/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.dataTables.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="js/exceljs.min.js"></script>
    <script src="js/exporter.js"></script>
    <script>
      document
        .getElementById("exportBtn")
        .addEventListener("click", function () {
          // Define the URL of your API endpoint
          const apiUrl =
            "./php/volunteer/getAllVolunteers.php";
          // New keys mapping
          const newKeys = {
            id: "ID",
            interestReason: "Interest Reason",
            stayingDuration: "Staying Duration",
            skills: "Skills",
            GoFundMeRadio: "GoFundMe Radio",
            GoFundMeOtherReason: "GoFundMe Other Reason",
            ideas: "Ideas",
            email: "Email",
            phone: "Phone",
            status: "Status",
            createDate: "Create Date",
          };
          // Call the function to fetch, rename, and export data
          fetchAndExportToExcel(apiUrl, newKeys,'Volunteers');
        });
      $(document).ready(function () {
        var table = $("#recordsTable").DataTable({
          processing: true,
          serverSide: true,
          ajax: {
            url: "php/volunteer/volunteerList.php",
            type: "GET",
          },
          columns: [
            { data: "id", orderable: false, searchable: false },
            { data: "interestReason", orderable: false, searchable: false },
            { data: "stayingDuration", orderable: false, searchable: false },
            { data: "skills", orderable: false, searchable: false },
            { data: "GoFundMeRadio", orderable: false, searchable: false },
            {
              data: "GoFundMeOtherReason",
              orderable: false,
              searchable: false,
            },
            { data: "ideas", orderable: false, searchable: false },
            { data: "email", orderable: false, searchable: false },
            { data: "phone", orderable: false, searchable: false },
            { data: "status", orderable: false, searchable: false },
            { data: "createDate", orderable: false, searchable: false },
            { data: "action", orderable: false, searchable: false },
          ],
        });

        $("#recordsTable").on("click", ".view-btn", function () {
          var id = $(this).data("id");
          $.ajax({
            url: "php/volunteer/volunteerRecord.php",
            type: "GET",
            data: { id: id },
            success: function (data) {
              var record = JSON.parse(data);
              var subject = "Leap Of Dance Academy";
              var body =
                "Hello,\n\nThank you for your message. We have received your Volunteering request and will respond shortly.\n\nBest regards,\nLeap Of Dance Academy";

              $("#viewId").val(record.id);
              $("#viewInterestReason").val(record.interestReason);
              $("#viewStayingDuration").val(record.stayingDuration);
              $("#viewSkills").val(record.skills);
              $("#viewGoFundMeRadio").val(record.GoFundMeRadio);
              $("#viewGoFundMeOtherReason").val(record.GoFundMeOtherReason);
              $("#viewIdeas").val(record.ideas);
              $("#viewEmail").val(record.email);
              $("#viewEmailLink").attr(
                "href",
                "mailto:" +
                  record.email +
                  "?subject=" +
                  encodeURIComponent(subject) +
                  "&body=" +
                  encodeURIComponent(body)
              );
              $("#viewPhone").val(record.phone);
              $("#viewStatus").val(record.status);
              $("#viewCreateDate").val(record.createDate);
              $("#viewModal").modal("show");
              table.ajax.reload(null, false);
            },
          });
        });
      });
    </script>
  </body>
</html>
